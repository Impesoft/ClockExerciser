<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:sfRadialGauge="clr-namespace:Syncfusion.Maui.Gauges;assembly=Syncfusion.Maui.Gauges"
             x:Class="ClockExerciser.GamePage"
             Title="{Binding AppTitle}">
    <ScrollView>
        <VerticalStackLayout Padding="24" Spacing="18">

            <Grid ColumnDefinitions="*" ColumnSpacing="12">
            </Grid>

            <Label Text="{Binding InstructionText}" />

            <Border Padding="-20" BackgroundColor="{AppThemeBinding Light=#f5f5f5, Dark=#1f1f1f}" HorizontalOptions="Center">
                <Border.StrokeShape>
                    <Ellipse />
                </Border.StrokeShape>
                <sfRadialGauge:SfRadialGauge HeightRequest="320" WidthRequest="320">
                    <sfRadialGauge:SfRadialGauge.Axes>
                        <sfRadialGauge:RadialAxis Minimum="0"
                                                  Maximum="12"
                                                  Interval="1"
                                                  MinorTicksPerInterval="4"
                                                  StartAngle="270"
                                                  EndAngle="270"
                                                  ShowLabels="True"
                                                  ShowAxisLine="False"
                                                  ShowLastLabel="False"
                                                  LabelCreated="HourAxis_LabelCreated">
                            <sfRadialGauge:RadialAxis.Pointers>
                                <sfRadialGauge:NeedlePointer Value="{Binding HourPointerValue}"
                                                             NeedleLengthUnit="Factor"
                                                             NeedleLength="0.60"
                                                             NeedleStartWidth="5"
                                                             NeedleEndWidth="5"
                                                             KnobSizeUnit="Factor"
                                                             KnobRadius="0.08"
                                                             TailLength="0.05"
                                                             TailLengthUnit="Factor"
                                                             NeedleFill="#1b1b1b" />
                                <sfRadialGauge:NeedlePointer Value="{Binding MinutePointerValue}"
                                                             NeedleLengthUnit="Factor"
                                                             NeedleLength="0.90"
                                                             NeedleStartWidth="4"
                                                             NeedleEndWidth="4"
                                                             KnobSizeUnit="Factor"
                                                             KnobRadius="0.08"
                                                             NeedleFill="#333333" />
                                <sfRadialGauge:NeedlePointer Value="{Binding SecondPointerValue}"
                                                             NeedleLengthUnit="Factor"
                                                             NeedleLength="1"
                                                             NeedleStartWidth="1"
                                                             NeedleEndWidth="1"
                                                             KnobSizeUnit="Factor"
                                                             KnobRadius="0.05"
                                                             NeedleFill="#d84315" />
                            </sfRadialGauge:RadialAxis.Pointers>
                        </sfRadialGauge:RadialAxis>
                    </sfRadialGauge:SfRadialGauge.Axes>
                </sfRadialGauge:SfRadialGauge>
            </Border>

            <VerticalStackLayout Spacing="4" IsVisible="{Binding IsTimeToClock}">
                <Label Text="{Binding PromptLabel}" FontAttributes="Bold" />
                <Label Text="{Binding PromptText}" />
                <Label Text="{Binding PromptDigital}" FontAttributes="Bold" />
            </VerticalStackLayout>

            <Entry Placeholder="{Binding EntryPlaceholder}"
                   IsVisible="{Binding IsClockToTime}"
                   Keyboard="Chat"
                   ClearButtonVisibility="WhileEditing"
                   Text="{Binding AnswerText, Mode=TwoWay}" />

            <VerticalStackLayout Spacing="8" IsVisible="{Binding IsTimeToClock}">
                <Label Text="{Binding HourLabel}" FontAttributes="Bold" />
                <Slider Minimum="-12"
                        Maximum="12"
                        Value="{Binding UserHourValue, Mode=TwoWay}"
                        MinimumTrackColor="{AppThemeBinding Light=#2196F3, Dark=#64B5F6}"
                        MaximumTrackColor="{AppThemeBinding Light=#BDBDBD, Dark=#757575}"
                        DragCompleted="HourSlider_DragCompleted" />
                <Label Text="{Binding MinuteLabel}" FontAttributes="Bold" />
                <Slider Minimum="-60"
                        Maximum="60"
                        Value="{Binding UserMinuteValue, Mode=TwoWay}"
                        MinimumTrackColor="{AppThemeBinding Light=#4CAF50, Dark=#81C784}"
                        MaximumTrackColor="{AppThemeBinding Light=#BDBDBD, Dark=#757575}"/>
            </VerticalStackLayout>

            <!-- Score Display -->
            <HorizontalStackLayout HorizontalOptions="End" Spacing="8">
                <Label Text="Score:" FontAttributes="Bold" VerticalOptions="Center"/>
                <Label Text="{Binding ScoreText}" 
                       FontSize="20" 
                       FontAttributes="Bold" 
                       TextColor="#2e7d32"
                       VerticalOptions="Center"/>
            </HorizontalStackLayout>

            <!-- Single Primary Action Button -->
            <Button Text="{Binding PrimaryButtonText}"
                    Command="{Binding CheckAnswerCommand}"
                    IsEnabled="{Binding CanSubmit}"
                    HorizontalOptions="Fill" />

            <Label Text="{Binding ResultMessage}"
                   IsVisible="{Binding ResultVisible}"
                   HorizontalTextAlignment="Center"
                   FontAttributes="Bold">
                <Label.Triggers>
                    <DataTrigger TargetType="Label"
                                Binding="{Binding ResultSuccess}"
                                Value="True">
                        <Setter Property="TextColor" Value="#2e7d32" />
                    </DataTrigger>
                    <DataTrigger TargetType="Label"
                                Binding="{Binding ResultSuccess}"
                                Value="False">
                        <Setter Property="TextColor" Value="#c62828" />
                    </DataTrigger>
                </Label.Triggers>
            </Label>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>





